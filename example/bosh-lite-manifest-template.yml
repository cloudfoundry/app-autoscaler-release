---

director_uuid: ((merge))
name: app-autoscaler-release

## Release Details ###
releases:
  - name: app-autoscaler
    version: latest
  - name: postgres
    url: https://bosh.io/d/github.com/cloudfoundry/postgres-release?v=11
    version: '11'
    sha1: b9cbcbfa53c870441f55431ee4ef8f63f860b03a

## Stemcell details ##
stemcells:
  - alias: default
    os: ubuntu-trusty
    version: latest

## Canary details ##
update:
  canaries: 1
  canary_watch_time: 1000-300000
  max_in_flight: 3
  update_watch_time: 1000-300000


instance_groups:
  - name: postgres
    azs:
      - z1
    instances: 1
    jobs:
      - name: postgres
        properties:
          databases: (( dbs ))
        release: postgres
        update:
          serial: true
    networks:
      - name: default
        static_ips: 10.244.4.2
    stemcell: default
    vm_type: default
  
  - name: apiserver
    azs:
      - z1
    instances: 1
    jobs:
      - name: apiserver
        properties:
          api_server: (( api_server_properties ))
          databases: (( dbs ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.3
    stemcell: default
    vm_type: default

  - name: scheduler
    azs:
      - z1
    instances: 1
    jobs:
      - name: scheduler
        properties:
          scheduler: (( scheduler_properties ))
          databases: (( dbs ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.4
    stemcell: default
    vm_type: default

  - name: servicebroker
    azs:
      - z1
    instances: 1
    jobs:
      - name: servicebroker
        properties:
          service_broker: (( service_broker_properties ))
          databases: (( dbs ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.5
    stemcell: default
    vm_type: default

  - name: pruner
    azs:
      - z1
    instances: 1
    jobs:
      - name: pruner
        properties:
          databases: (( dbs ))
          pruner: (( pruner_properties ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.10
    stemcell: default
    vm_type: default

  - name: metricscollector
    azs:
      - z1
    instances: 1
    jobs:
      - name: metricscollector
        properties:
          databases: (( dbs ))
          cf: (( cf_properties ))
          metricscollector: (( metricscollector_properties ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.7
    stemcell: default
    vm_type: default

  - name: eventgenerator
    azs:
      - z1
    instances: 1
    jobs:
      - name: eventgenerator
        properties:
          databases: (( dbs ))
          eventgenerator: (( eventgenerator_properties ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.8
    stemcell: default
    vm_type: default


  - name: scalingengine
    azs:
      - z1
    instances: 1
    jobs:
      - name: scalingengine
        properties:
          databases: (( dbs ))
          cf: (( cf_properties ))
          scalingengine: (( scalingengine_properties ))
        release: app-autoscaler
    networks:
      - name: default
        static_ips: 10.244.4.9
    stemcell: default
    vm_type: default


dbs: (( merge ))
cf_properties: (( merge ))
api_server_properties: (( merge ))
scheduler_properties: (( merge ))
service_broker_properties: ((merge))
pruner_properties: ((merge))
metricscollector_properties: (( merge ))
eventgenerator_properties: (( merge ))
scalingengine_properties: (( merge ))


